(window.webpackJsonp=window.webpackJsonp||[]).push([[10,30,31],{145:function(e,t,a){"use strict";a.r(t),a.d(t,"PeopleSelector",(function(){return T}));var n=a(44),r=a.n(n),s=a(45),o=a.n(s),i=a(46),c=a.n(i),l=a(47),u=a.n(l),m=a(40),d=a.n(m),f=a(48),p=a.n(f),v=a(19),E=a.n(v),g=a(0),h=a.n(g),b=a(24),y=a(250),S=a(249),N=a(260),C=a(251),x=a(259),M=a(67),O=a(59),j=a(12),_=a(10),T=function(e){function t(e){var a;r()(this,t),a=c()(this,u()(t).call(this,e)),E()(d()(a),"state",void 0),E()(d()(a),"toggleUser",(function(e){var t=a.state.people;t.map((function(e){return e._id})).includes(e._id)?a.setState({people:t.filter((function(t){return t._id!==e._id}))}):a.setState({people:t.concat(e)})}));var n=e.selectedUserIds,s=e.users,o=[];return n.length>0&&(o=s.filter((function(e){return n.includes(e._id)}))),a.state={searchText:"",people:o},a}return p()(t,e),o()(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.people,n=t.searchText,r=this.props,s=r.users,o=r.excludedUserIds,i=r.submitButtonText,c=r.onSubmit,l=r.onCancel,u=r.translation;return s=s.filter((function(e){return!o.includes(e._id)})),n&&(s=s.filter((function(e){return-1!==e.username.toLowerCase().indexOf(n.toLowerCase())}))),s=Object(j.orderBy)(s,["username"]),h.a.createElement("div",null,h.a.createElement("div",{className:"people-select-header"},h.a.createElement(x.a,{size:"sm",className:"search"},h.a.createElement(x.a.Prepend,null,h.a.createElement("i",{className:"fas fa-search"})),h.a.createElement(C.a.Control,{placeholder:u.PEOPLE.SEARCH_PEOPLE,"aria-label":"Search people","aria-describedby":"search",className:"search-input",value:n,onChange:function(t){return e.setState({searchText:t.target.value})}})),h.a.createElement("div",{className:"actions"},h.a.createElement(M.a,{size:"sm",variant:"outline-secondary",onClick:l},u.COMMON.CANCEL)," ",h.a.createElement(M.a,{size:"sm",variant:"success",disabled:0===a.length,onClick:function(){return c(a)}},i||u.COMMON.SUBMIT))),0===s.length?h.a.createElement("div",{className:"text-center"},u.COMMON.NO_RESULTS):h.a.createElement(N.a,{hover:!0},h.a.createElement("tbody",null,s.map((function(t){var n=a.map((function(e){return e._id})).includes(t._id);return h.a.createElement("tr",{key:t._id,id:t._id},h.a.createElement("td",{className:n?"active":"",style:{padding:5},onClick:function(){return e.toggleUser(t)}},h.a.createElement(y.a,{noGutters:!0},h.a.createElement(S.a,{xs:10},h.a.createElement("div",{className:"profile-picture-wrapper"},h.a.createElement(O.a,{roundedCircle:!0,style:t.online?_.ONLINE_STYLE:{},className:"profile-picture",src:t.pictureUrl?t.pictureUrl:"/images/default-profile.jpg"})),h.a.createElement("div",{style:{fontSize:13}},h.a.createElement("span",{style:{fontWeight:700}},t.username),h.a.createElement("div",{style:{color:"grey"}},!t.online&&"".concat(u.PEOPLE.LAST_SEEN," ").concat(Object(j.timestampToHumanDate)(t.lastTime,!1,u))))),h.a.createElement(S.a,{xs:2},h.a.createElement("div",{className:"material-switch pull-right",style:{marginTop:12}},h.a.createElement("input",{type:"checkbox",checked:n,onChange:function(){}}),h.a.createElement("label",{className:"label-success"}))))))})))))}}]),t}(h.a.PureComponent);E()(T,"defaultProps",{excludedUserIds:[],selectedUserIds:[],submitButtonText:""}),t.default=Object(b.b)((function(e){return{users:e.users.users,translation:e.translation}}))(T)},149:function(e,t,a){"use strict";a.r(t);var n=a(44),r=a.n(n),s=a(45),o=a.n(s),i=a(46),c=a.n(i),l=a(47),u=a.n(l),m=a(48),d=a.n(m),f=a(0),p=a.n(f),v=a(24),E=a(489),g=a.n(E),h=a(59),b=a(49),y=a(12),S=a(10),N=function(e){function t(){return r()(this,t),c()(this,u()(t).apply(this,arguments))}return d()(t,e),o()(t,[{key:"render",value:function(){var e=this.props,t=e.message,a=e.user,n=e.users,r=e.deleteMessage,s=e.translation,o=t.from._id===a._id,i=n.find((function(e){return e._id===t.from._id}));return p.a.createElement("div",null,p.a.createElement("div",{className:"profile-picture-wrapper"},p.a.createElement(h.a,{roundedCircle:!0,style:i.online?S.ONLINE_STYLE:{},className:"profile-picture",src:i.pictureUrl?i.pictureUrl:"/images/default-profile.jpg"})),p.a.createElement("div",{className:"message-top"},p.a.createElement("div",null,p.a.createElement("span",{className:"message-from"},t.from.username),p.a.createElement("span",{className:"message-time"},t.timestamp?Object(y.timestampToHumanDate)(t.timestamp,!0,s):s.MESSAGES.SENDING),p.a.createElement(g.a,{properties:{target:"_blank"}},p.a.createElement("div",{className:"message-text"},t.text))),o&&p.a.createElement("div",null,p.a.createElement("i",{id:"delete",className:"far fa-trash-alt pull-right cursor",title:s.MESSAGES.DELETE,style:{color:"grey"},onClick:function(){return r(t._id)}}))))}}]),t}(p.a.PureComponent);t.default=Object(v.b)((function(e){return{user:e.authentication.user,users:e.users.users,translation:e.translation}}),{deleteMessage:b.deleteMessage})(N)},150:function(e,t,a){"use strict";a.r(t),a.d(t,"MessageForm",(function(){return M}));var n=a(44),r=a.n(n),s=a(45),o=a.n(s),i=a(46),c=a.n(i),l=a(47),u=a.n(l),m=a(40),d=a.n(m),f=a(48),p=a.n(f),v=a(19),E=a.n(v),g=a(0),h=a.n(g),b=a(24),y=a(499),S=a(250),N=a(249),C=a(251),x=a(49),M=function(e){function t(e){var a;return r()(this,t),a=c()(this,u()(t).call(this,e)),E()(d()(a),"state",void 0),E()(d()(a),"textAreaRef",h.a.createRef()),E()(d()(a),"handleKeyPress",(function(e){if("Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),a.state.messageText)){var t=a.props,n=t.user,r=t.conversation,s={from:{_id:n._id,username:n.username},text:a.state.messageText,timestamp:null,read:!1,deleted:!1};r.messages.push(s),r.timestamp=null,a.props.saveConversation(r),a.setState({messageText:""})}})),E()(d()(a),"onEmojiClick",(function(){return a.setState({showEmoji:!a.state.showEmoji})})),E()(d()(a),"setText",(function(e){var t=a.textAreaRef.current,n=t.selectionStart,r=t.selectionEnd,s=t.value,o="".concat(s.substring(0,n)).concat(e).concat(s.substring(r));t.focus(),t.selectionEnd=r+7,a.setState({messageText:o})})),a.state={messageText:"",showEmoji:!1},a}return p()(t,e),o()(t,[{key:"render",value:function(){var e=this,t=this.props.translation,a=this.state,n=a.messageText,r=a.showEmoji,s=r?{paddingRight:0}:{},o=r?{paddingLeft:0}:{};return h.a.createElement(S.a,{noGutters:!0},h.a.createElement(N.a,{xs:12,sm:r?7:12,style:s},h.a.createElement(C.a,null,h.a.createElement(C.a.Group,{controlId:"message-form",className:"message-form",style:{display:"flex",marginBottom:2}},h.a.createElement("div",{style:{flex:1}},h.a.createElement(C.a.Control,{id:"message-textarea",ref:this.textAreaRef,as:"textarea",autoFocus:!0,className:"text-area",rows:4,placeholder:this.props.translation.MESSAGES.WRITE_MESSAGE,value:n,onKeyPress:this.handleKeyPress,onChange:function(t){return e.setState({messageText:t.target.value})}}),h.a.createElement(C.a.Text,{className:"text-muted d-none d-sm-block"},this.props.translation.MESSAGES.WRITE_MESSAGE_INFO)),h.a.createElement("div",{className:"emoji-select-area"},h.a.createElement(y.a,{set:"twitter",size:32,emoji:r?"grinning":"slightly_smiling_face",onClick:function(){return e.onEmojiClick()}}))))),h.a.createElement(N.a,{xs:12,sm:r?5:12,style:o},r&&h.a.createElement(y.b,{title:t.MESSAGES.PICK_EMOJI,emoji:"monkey",native:!0,onClick:function(t){return e.setText(t.native)}})))}}]),t}(h.a.Component);t.default=Object(b.b)((function(e){return{user:e.authentication.user,conversation:e.conversations.conversation,translation:e.translation}}),{saveConversation:x.saveConversation})(M)},161:function(e,t,a){"use strict";a.r(t);var n=a(44),r=a.n(n),s=a(45),o=a.n(s),i=a(46),c=a.n(i),l=a(47),u=a.n(l),m=a(40),d=a.n(m),f=a(48),p=a.n(f),v=a(19),E=a.n(v),g=a(0),h=a.n(g),b=a(24),y=a(266),S=a.n(y),N=a(253),C=a(250),x=a(249),M=a(260),O=a(259),j=a(251),_=a(273),T=a(67),A=a(267),k=a(13),w=a(49),R=a(12),U=a(60),I=a(145),P=a(149),L=a(150),G=function(e){function t(e){var a;return r()(this,t),a=c()(this,u()(t).call(this,e)),E()(d()(a),"state",void 0),E()(d()(a),"interval",void 0),E()(d()(a),"scrollableTable",void 0),E()(d()(a),"scrollConversationToBottom",(function(){if(a.scrollableTable){var e=a.scrollableTable;e.scrollHeight-e.clientHeight<=e.scrollTop+1||(e.scrollTop=e.scrollHeight-e.clientHeight)}})),E()(d()(a),"getConversation",(function(){var e=S.a.parse(a.props.location.search),t=e.convId,n=e.userIds;if(t)a.props.getConversation(t);else if(n){var r=[];if(Array.isArray(n))r=n.concat(a.props.user._id);else r=a.props.user._id===n?[n]:[a.props.user._id,n];a.props.getConversationWithUsers(r)}})),E()(d()(a),"onSearch",(function(e){if(""===e)a.setState({filteredMessages:a.props.conversation.messages});else{var t=a.props.conversation.messages.filter((function(t){return-1!==t.text.toLowerCase().indexOf(e.toLowerCase())}));a.setState({filteredMessages:t})}})),E()(d()(a),"showMembersModal",(function(e){return a.setState({showModal:e})})),E()(d()(a),"manageMembers",(function(e){var t=a.props,n=t.conversation,r=t.saveConversation,s=t.alertSuccess,o=t.translation,i=e.map((function(e){return{_id:e._id,username:e.username}}));n.users=i,r(n),a.showMembersModal(!1),s(o.MESSAGES.MEMBERS_EDITED(i.map((function(e){return e.username}))))})),E()(d()(a),"renderMessages",(function(){var e=a.state.filteredMessages.filter((function(e){return!e.deleted})),t=[],n=[];e.forEach((function(e){e.timestamp?t.push(e):n.push(e)}));var r=Object(R.orderBy)(t,"timestamp"),s=function(e){return e.map((function(e,t){var a=e.read?"":"unread-message";return h.a.createElement("tr",{key:e._id||t,className:a},h.a.createElement("td",{style:{padding:8}},h.a.createElement(P.default,{message:e})))}))};return h.a.createElement("div",{className:"messages-table",ref:function(e){a.scrollableTable=e}},h.a.createElement(M.a,null,h.a.createElement("tbody",null,s(r),s(n))))})),a.state={showModal:!1,messages:[],filteredMessages:[]},a.scrollableTable={},a}return p()(t,e),o()(t,[{key:"componentDidMount",value:function(){var e=this;this.props.isConversationsLoaded||this.props.getConversationsByUser(this.props.user._id),this.getConversation(),setTimeout((function(){return e.props.markAsRead()}),800)}},{key:"componentDidUpdate",value:function(e){var t=this;this.scrollConversationToBottom();var a=e.conversation.messages||[],n=this.props.conversation.messages||[];a.length!==n.length&&setTimeout((function(){return t.props.markAsRead()}),500)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval),this.props.conversationCleanup()}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.conversation,r=t.conversations,s=t.isConversationsLoaded,o=t.isConversationLoaded,i=t.translation,c=r.some((function(e){return e._id===n._id})),l=null;if(!s||!o)l=h.a.createElement("div",{style:{paddingTop:"50vh"}},h.a.createElement(U.default,null));else if(c){l=n.users.map((function(e){return e._id})).includes(a._id)?h.a.createElement("div",null,this.renderMessages(),h.a.createElement(L.default,null)):h.a.createElement(A.a,{className:"text-center"},h.a.createElement("p",null,i.MESSAGES.YOU_NOT_MEMBER))}else l=h.a.createElement(A.a,{className:"text-center"},h.a.createElement("p",null,i.CONVERSATIONS.CONVERSATION_NOT_FOUND));return h.a.createElement(N.a,{fluid:!0},h.a.createElement(C.a,null,h.a.createElement(x.a,{md:{span:10,offset:1},lg:{span:8,offset:2}},h.a.createElement("div",{className:"header"},h.a.createElement("div",{style:{color:"grey"}},h.a.createElement("div",{style:{color:"grey"}},h.a.createElement(O.a,{size:"sm",className:"search-container"},h.a.createElement(O.a.Prepend,null,h.a.createElement("i",{className:"fas fa-search"})),h.a.createElement(j.a.Control,{placeholder:i.CONVERSATIONS.SEARCH_IN_MESSAGES,"aria-label":"Search messages","aria-describedby":"search",className:"search-input",onChange:function(t){return e.onSearch(t.target.value)}})))),h.a.createElement(T.a,{variant:"outline-dark",className:"d-none d-sm-block",size:"sm",onClick:function(){return e.showMembersModal(!0)}},h.a.createElement("i",{className:"fa fa-users fa-lg",style:{marginRight:8}}),i.MESSAGES.MANAGE_MEMBERS),h.a.createElement(T.a,{variant:"outline-dark",className:"d-block d-sm-none btn-mobile-icon",title:i.MESSAGES.MANAGE_MEMBERS,onClick:function(){return e.showMembersModal(!0)}},h.a.createElement("i",{className:"fa fa-users fa-lg"}))),l,n.users&&h.a.createElement(_.a,{size:"lg",show:this.state.showModal,onHide:function(){return e.showMembersModal(!1)}},h.a.createElement(_.a.Header,{closeButton:!0},h.a.createElement(_.a.Title,null,i.MESSAGES.MANAGE_MEMBERS)),h.a.createElement(_.a.Body,null,h.a.createElement(I.default,{selectedUserIds:n.users.map((function(e){return e._id})),onSubmit:function(t){return e.manageMembers(t)},onCancel:function(){return e.showMembersModal(!1)}})),h.a.createElement(_.a.Footer,{className:"manage-people-footer text-danger"},h.a.createElement("i",{className:"fas fa-exclamation-triangle",style:{marginRight:8}})," ",i.MESSAGES.NEW_MEMBERS_NOTE)))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.conversation.messages!==t.messages?{messages:e.conversation.messages,filteredMessages:e.conversation.messages}:null}}]),t}(h.a.Component);t.default=Object(b.b)((function(e){return{user:e.authentication.user,users:e.users.users,conversation:e.conversations.conversation,conversations:e.conversations.conversations,isConversationsLoaded:e.conversations.isConversationsLoaded,isConversationLoaded:e.conversations.isConversationLoaded,translation:e.translation}}),{getConversationsByUser:w.getConversationsByUser,getConversation:w.getConversation,getConversationWithUsers:w.getConversationWithUsers,markAsRead:w.markAsRead,deleteMessage:w.deleteMessage,saveConversation:w.saveConversation,conversationCleanup:w.conversationCleanup,alertSuccess:k.alertSuccess})(G)},253:function(e,t,a){"use strict";var n=a(2),r=a(3),s=a(4),o=a.n(s),i=a(0),c=a.n(i),l=a(5),u=c.a.forwardRef((function(e,t){var a=e.bsPrefix,s=e.fluid,i=e.as,u=void 0===i?"div":i,m=e.className,d=Object(r.a)(e,["bsPrefix","fluid","as","className"]),f=Object(l.b)(a,"container");return c.a.createElement(u,Object(n.a)({ref:t},d,{className:o()(m,s?f+"-fluid":f)}))}));u.displayName="Container",u.defaultProps={fluid:!1},t.a=u},259:function(e,t,a){"use strict";var n=a(2),r=a(3),s=a(4),o=a.n(s),i=a(0),c=a.n(i),l=a(29),u=a(5),m=c.a.forwardRef((function(e,t){var a=e.bsPrefix,s=e.size,i=e.className,l=e.as,m=void 0===l?"div":l,d=Object(r.a)(e,["bsPrefix","size","className","as"]);return a=Object(u.b)(a,"input-group"),c.a.createElement(m,Object(n.a)({ref:t},d,{className:o()(i,a,s&&a+"-"+s)}))})),d=Object(l.a)("input-group-append"),f=Object(l.a)("input-group-prepend"),p=Object(l.a)("input-group-text",{Component:"span"});m.displayName="InputGroup",m.Text=p,m.Radio=function(e){return c.a.createElement(p,null,c.a.createElement("input",Object(n.a)({type:"radio"},e)))},m.Checkbox=function(e){return c.a.createElement(p,null,c.a.createElement("input",Object(n.a)({type:"checkbox"},e)))},m.Append=d,m.Prepend=f,t.a=m},260:function(e,t,a){"use strict";var n=a(2),r=a(3),s=a(4),o=a.n(s),i=a(0),c=a.n(i),l=a(5),u=c.a.forwardRef((function(e,t){var a=e.bsPrefix,s=e.className,i=e.striped,u=e.bordered,m=e.borderless,d=e.hover,f=e.size,p=e.variant,v=e.responsive,E=Object(r.a)(e,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),g=Object(l.b)(a,"table"),h=o()(s,g,p&&g+"-"+p,f&&g+"-"+f,i&&g+"-striped",u&&g+"-bordered",m&&g+"-borderless",d&&g+"-hover"),b=c.a.createElement("table",Object(n.a)({},E,{className:h,ref:t}));if(v){var y=g+"-responsive";return"string"==typeof v&&(y=y+"-"+v),c.a.createElement("div",{className:y},b)}return b}));t.a=u},266:function(e,t,a){"use strict";var n=a(271),r=a(102),s=a(272);function o(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function i(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function c(e,t){var a=function(e){var t;switch(e.arrayFormat){case"index":return function(e,a,n){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=a):n[e]=a};case"bracket":return function(e,a,n){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],a):n[e]=[a]:n[e]=a};default:return function(e,t,a){void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t=r({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),r=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:s(o),a(s(r),o,n)})),Object.keys(n).sort().reduce((function(e,t){var a=n[t];return Boolean(a)&&"object"==typeof a&&!Array.isArray(a)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(a):e[t]=a,e}),Object.create(null))):n}t.extract=i,t.parse=c,t.stringify=function(e,t){!1===(t=r({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var a=function(e){switch(e.arrayFormat){case"index":return function(t,a,n){return null===a?[o(t,e),"[",n,"]"].join(""):[o(t,e),"[",o(n,e),"]=",o(a,e)].join("")};case"bracket":return function(t,a){return null===a?o(t,e):[o(t,e),"[]=",o(a,e)].join("")};default:return function(t,a){return null===a?o(t,e):[o(t,e),"=",o(a,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(n){var r=e[n];if(void 0===r)return"";if(null===r)return o(n,t);if(Array.isArray(r)){var s=[];return r.slice().forEach((function(e){void 0!==e&&s.push(a(n,e,s.length))})),s.join("&")}return o(n,t)+"="+o(r,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:c(i(e),t)}}},267:function(e,t,a){"use strict";var n=a(2),r=a(3),s=a(0),o=a.n(s),i=a(4),c=a.n(i),l=a(5),u=o.a.forwardRef((function(e,t){var a,s=e.as,i=void 0===s?"div":s,u=e.className,m=e.fluid,d=e.bsPrefix,f=Object(r.a)(e,["as","className","fluid","bsPrefix"]),p=((a={})[d=Object(l.b)(d,"jumbotron")]=!0,a[d+"-fluid"]=m,a);return o.a.createElement(i,Object(n.a)({ref:t},f,{className:c()(u,p)}))}));u.defaultProps={fluid:!1},u.displayName="Jumbotron",t.a=u},271:function(e,t,a){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},272:function(e,t,a){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),r=new RegExp("(%[a-f0-9]{2})+","gi");function s(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],s(a),s(n))}function o(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(n),a=1;a<t.length;a++)t=(e=s(t,a).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},a=r.exec(e);a;){try{t[a[0]]=decodeURIComponent(a[0])}catch(e){var n=o(a[0]);n!==a[0]&&(t[a[0]]=n)}a=r.exec(e)}t["%C2"]="�";for(var s=Object.keys(t),i=0;i<s.length;i++){var c=s[i];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}}}]);